# 计算机网络

------

## TCP

### TCP如何保证传输的可靠性？

------

- **确认和重传机制**：TCP使用确认和重传机制来确保数据的可靠传输。发送方在发送数据后，会等待接收方发送确认（ACK）信号。如果发送方在合理的时间内未收到确认，就会认为数据丢失，触发重传机制，重新发送数据。
- **序列号和校验和**：TCP在每个数据包中都包含序列号和校验和。序列号用于对数据包进行排序和重组，以保证数据的顺序性；而校验和用于检测数据在传输过程中是否发生了损坏或改变。如果接收方检测到校验和错误，会请求发送方重传数据。
- **流量控制**：TCP使用滑动窗口机制进行流量控制，确保发送方发送的数据不会超过接收方处理的能力。接收方通过通告窗口大小，控制发送方的发送速率，从而防止数据丢失。
- **拥塞控制**：TCP通过拥塞控制算法来避免网络拥塞，并在发生拥塞时降低数据的发送速率。拥塞控制算法包括慢启动、拥塞避免、快速重传和快速恢复等。

### TCP拥塞控制

------

TCP 拥塞控制是 TCP 协议中的一种重要机制，用于在网络拥塞时调整数据传输的速率，以确保网络的稳定性和公平性。TCP 拥塞控制包括以下几个过程：

1、**慢启动（Slow Start）**：

- 当 TCP 连接建立或者在网络中断重连后，慢启动阶段开始。
- 发送端维护一个叫做拥塞窗口（cwnd）的变量，初始值为一个较小的数值（通常为1个报文段大小）。
- 在每次收到对方的确认时，拥塞窗口大小翻倍，即指数增长，这样发送端可以逐渐增加发送的数据量。
- 慢启动阶段持续到拥塞窗口达到一个阈值（拥塞避免阈值）。

2、**拥塞避免（Congestion Avoidance）**：

- 一旦拥塞窗口达到拥塞避免阈值，TCP 进入拥塞避免阶段。
- 拥塞避免阶段中，每经过一个往返时间（RTT），拥塞窗口大小只增加 1 个报文段大小，即线性增长。
- 这种线性增长的方式更加稳健，可以缓解网络拥塞可能导致的问题。

3、**快速重传（Fast Retransmit）**：

- 如果发送端连续收到 3 个重复的确认（Duplicate ACK），就认为某个报文段丢失了。
- 在收到第三个重复确认时，发送端立即重传丢失的报文段，而不是等待超时重传触发。
- 这样可以更快地恢复丢失的报文段，减少数据重传的延迟。

4、**快速恢复（Fast Recovery）**：

- 当发送端收到第一个重复确认时，进入快速恢复阶段。
- 发送端将拥塞窗口减半，并设置拥塞避免阈值为当前拥塞窗口的一半。
- 然后，发送端继续执行拥塞避免算法，即每个 RTT 只增加一个报文段大小。
- 快速恢复阶段旨在降低拥塞窗口的大小，以减少对网络的负载，同时保持连接的稳定性。
- 通过这些过程，TCP 拥塞控制可以在网络拥塞时调整数据传输的速率，从而确保网络的稳定性，并尽量避免数据丢失和重传。

### TCP半包和粘包

------

**半包问题**：当发送方将数据拆分成较小的数据包发送，而接收方一次性读取的数据量小于发送方发送的数据包大小时，就会导致接收方接收到的数据不完整，即出现了半包问题。

**粘包问题**：与半包问题相反，粘包问题是指接收方一次性读取的数据量大于发送方发送的数据包大小，导致接收方在一次读取中接收到了多个数据包的数据，造成数据粘在一起的情况。

这些问题通常是由于TCP协议的特性导致的，如**TCP是基于字节流传输的、无消息边界**等。解决这些问题的方法包括使用消息边界标记、消息长度前缀、定长消息等方式进行数据分割和组织，以及在应用层进行数据的解析和处理。

## 限流

限流是当高并发或者瞬时高并发时，为了保证系统的稳定性、可用性，对超出服务处理能力之外的请求进行拦截，对访问服务的流量进行限制。

常见的限流算法有四种：固定窗口限流算法、滑动窗口限流算法、漏桶限流算法和令牌桶限流算法。

- **固定窗口限流算法**实现简单，容易理解，但是流量曲线可能不够平滑，有“突刺现象”，在窗口切换时可能会产生两倍于阈值流量的请求。
- **滑动窗口限流算法**是对固定窗口限流算法的改进，有效解决了窗口切换时可能会产生两倍于阈值流量请求的问题。
- **漏桶限流算法**能够对流量起到整流的作用，让随机不稳定的流量以固定的速率流出，但是不能解决**流量突发**的问题。
- **令牌桶算法**作为漏斗算法的一种改进，除了能够起到平滑流量的作用，还允许一定程度的流量突发。

## HTTP

### HTTP和HTTPS的区别

------

